<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Línea Curva Dinámica</title>
    <link rel="stylesheet" href="main.css">
    <link href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css" rel="stylesheet">
    <style>
        .timeline {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 50px;
            position: relative;
        }

        .box {
            padding: 10px 20px;
            background-color: #8fbf82;
            color: white;
            border-radius: 15px;
            font-family: Arial, sans-serif;
            cursor: pointer;
            user-select: none;
        }

        canvas {
            border: 1px solid lightgray;
            position: absolute;
            top: 100px; /* Ajustamos la posición del canvas */
            left: 0;
            z-index: -1;
        }
    </style>
</head>
<body>

<div class="timeline" id="timeline">
  <div class="splide" id="splide-prueba" aria-label="Basic Structure Example">
    <div class="splide__track">
        <ul class="splide__list">
            <li class="splide__slide box" data-index="1">
                <div class="history">
                    <div class="info">
                        <h3>Antes del origen</h3>
                        <p>Esa noche, reventaron 36 bombas en Lima. El Perú estaba sumido en una crisis
                            ocasionada por el terrorismo. Había que decidir si seguir en el Perú o dejarlo todo
                            y viajar al extranjero.</p>
                    </div>
                    <button class="build-btn" data-progress="25">1992</button>
                </div>
            </li>
            <li class="splide__slide box" data-index="2">
                <div class="history">
                    <div class="info">
                        <h3>Antes del origen</h3>
                        <p>Esa noche, reventaron 36 bombas en Lima. El Perú estaba sumido en una crisis
                            ocasionada por el terrorismo. Había que decidir si seguir en el Perú o dejarlo todo
                            y viajar al extranjero.</p>
                    </div>
                    <button class="build-btn" data-progress="50">1993</button>
                </div>
            </li>
            <li class="splide__slide box" data-index="3">
                <div class="history">
                    <div class="info">
                        <h3>Antes del origen</h3>
                        <p>Esa noche, reventaron 36 bombas en Lima. El Perú estaba sumido en una crisis
                            ocasionada por el terrorismo. Había que decidir si seguir en el Perú o dejarlo todo
                            y viajar al extranjero.</p>
                    </div>
                    <button class="build-btn" data-progress="75">1994</button>
                </div>
            </li>
            <li class="splide__slide box" data-index="4">
                <div class="history">
                    <div class="info">
                        <h3>Antes del origen</h3>
                        <p>Esa noche, reventaron 36 bombas en Lima. El Perú estaba sumido en una crisis
                            ocasionada por el terrorismo. Había que decidir si seguir en el Perú o dejarlo todo
                            y viajar al extranjero.</p>
                    </div>
                    <button class="build-btn" data-progress="100">2000</button>
                </div>
            </li>
            <li class="splide__slide box" data-index="5">
                <div class="history">
                    <div class="info">
                        <h3>Antes del origen</h3>
                        <p>Esa noche, reventaron 36 bombas en Lima. El Perú estaba sumido en una crisis
                            ocasionada por el terrorismo. Había que decidir si seguir en el Perú o dejarlo todo
                            y viajar al extranjero.</p>
                    </div>
                    <button class="build-btn" data-progress="125">2004</button>
                </div>
            </li>
            <li class="splide__slide box" data-index="6">
                <div class="history">
                    <div class="info">
                        <h3>Antes del origen</h3>
                        <p>Esa noche, reventaron 36 bombas en Lima. El Perú estaba sumido en una crisis
                            ocasionada por el terrorismo. Había que decidir si seguir en el Perú o dejarlo todo
                            y viajar al extranjero.</p>
                    </div>
                    <button class="build-btn" data-progress="150">2010</button>
                </div>
            </li>
            <li class="splide__slide box" data-index="7">
                <div class="history">
                    <div class="info">
                        <h3>Antes del origen</h3>
                        <p>Esa noche, reventaron 36 bombas en Lima. El Perú estaba sumido en una crisis
                            ocasionada por el terrorismo. Había que decidir si seguir en el Perú o dejarlo todo
                            y viajar al extranjero.</p>
                    </div>
                    <button class="build-btn" data-progress="175">2022</button>
                </div>
            </li>
            <li class="splide__slide box" data-index="8">
                <div class="history">
                    <div class="info">
                        <h3>Antes del origen</h3>
                        <p>Esa noche, reventaron 36 bombas en Lima. El Perú estaba sumido en una crisis
                            ocasionada por el terrorismo. Había que decidir si seguir en el Perú o dejarlo todo
                            y viajar al extranjero.</p>
                    </div>
                    <button class="build-btn" data-progress="200">2023</button>
                </div>
            </li>
        </ul>
    </div>
</div>

</div>

<canvas id="canvas" width="1500" height="300"></canvas>

<script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
        const splide = new Splide('#splide-prueba', {
            type: 'slide',
            perPage: 4,
            perMove: 1,
            gap: '2rem',
            pagination: false,
            padding: {
                left: '30px',
                right: '40px'
            },
            breakpoints: {
                420:{
                    perPage: 2,
                    perMove: 1,
                }
            }
        }).mount();
    });
</script>
<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    const initialX = 150;
    const initialY = 150;
    const curveHeight = 100;
    const curveLength = 200;

    function drawCurve(progress, totalCurves) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.strokeStyle = '#6ab04c';
        ctx.lineWidth = 2;
        ctx.setLineDash([5, 5]);

        ctx.beginPath();
        ctx.moveTo(initialX, initialY);

        for (let i = 0; i < totalCurves; i++) {
            const startX = initialX + i * curveLength;
            const endX = startX + curveLength;
            const midX = (startX + endX) / 2;

            if (i < totalCurves - 1 || progress === 1) {
                // Dibujar curvas completas para segmentos anteriores
                if (i % 2 === 0) {
                    ctx.quadraticCurveTo(midX, initialY - curveHeight, endX, initialY);
                } else {
                    ctx.quadraticCurveTo(midX, initialY + curveHeight, endX, initialY);
                }
            } else {
                // Dibujar la última curva parcialmente
                const currentX = startX + (endX - startX) * progress;
                const currentMidX = startX + (midX - startX) * progress;
                if (i % 2 === 0) {
                    ctx.quadraticCurveTo(currentMidX, initialY - curveHeight * progress, currentX, initialY);
                } else {
                    ctx.quadraticCurveTo(currentMidX, initialY + curveHeight * progress, currentX, initialY);
                }
            }
        }

        ctx.stroke();
    }

    function animateCurve(totalCurves, duration) {
        const startTime = performance.now();

        function animate(currentTime) {
            const elapsedTime = currentTime - startTime;
            const progress = Math.min(elapsedTime / duration, 1);

            drawCurve(progress, totalCurves);

            if (progress < 1) {
                requestAnimationFrame(animate);
            }
        }

        requestAnimationFrame(animate);
    }

    document.querySelectorAll('.build-btn').forEach(button => {
        button.addEventListener('click', function() {
            const targetIndex = parseInt(this.closest('.box').getAttribute('data-index'));
            const totalCurves = targetIndex - 1;
            animateCurve(totalCurves, 1000); // 1000ms = 1 segundo para la animación completa
        });
    });
</script>

</body>
</html>
